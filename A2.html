<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <script type="text/javascript" src="./NodeGraphs.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900">
    <link rel="stylesheet" type="text/css" href="./nodeStyles.css">
    <title>Galetora</title>
  </head>
  <body>
    <div id = "app">
    </div>
    <input id = "jsonTreeText" type="text"/>
    <div id = "button">
      Render Object
    </div>
    <div class = "info">
      Insert tree as json object with a, b and children ar keys <br />
      node = {<br />
        a: interger_value,<br />
        b: interger_value,<br />
        children: [node1, node2, ...] or [] if leaf<br />
      }
    </div>
    <pre class = "function">def treeToJson(node):
      if node.is_external():
        return '{{"a": {0}, "b": {1}, "children": []}}'.format(node.key, node.subtree_value) <br />
      else:
        print_string = '{{"a": {0}, "b": {1}, "children": ['.format(node.key, node.subtree_value) <br />
        for child_node in node.children:
            print_string += treeToJson(child_node) + ','
        print_string = print_string[:-1]
        return print_string + "]}"</pre>
  </body>
  <script type="text/javascript">
    runMyScript = function(python_file_name, callback){
      fetch('http://localhost:3000/run/'+ python_file_name).then((response, err) => {
        if (err) throw err
        return response.json()
      }).then((responseJson) => {
        if(responseJson.error){
          console.error('SQL ERROR: ' + responseJson.error)
        }else{
          callback(responseJson)
        }
      }).catch((err) => {
        console.log(err);
      });
    }


    // runMyScript('test.py', (jsontree)=>{
    //   var nodeGraph = new NodeGraphs(jsontree, 'app');
    // })
    var nodeGraphOG = new NodeGraphs(JSON.parse('{"a": 0, "b": 28, "children": [{"a": 1, "b": 6, "children": [{"a": 4, "b": 4, "children": []},{"a": 5, "b": 5, "children": []},{"a": 6, "b": 6, "children": []}]},{"a": 2, "b": 28, "children": [{"a": 7, "b": 7, "children": []},{"a": 28, "b": 28, "children": []},{"a": 9, "b": 9, "children": []}]},{"a": 3, "b": 12, "children": [{"a": 10, "b": 10, "children": []},{"a": 11, "b": 11, "children": []},{"a": 12, "b": 12, "children": []}]}]}'), 'app');
    document.getElementById('jsonTreeText').value = '{"a": 0, "b": 28, "children": [{"a": 1, "b": 6, "children": [{"a": 4, "b": 4, "children": []},{"a": 5, "b": 5, "children": []},{"a": 6, "b": 6, "children": []}]},{"a": 2, "b": 28, "children": [{"a": 7, "b": 7, "children": []},{"a": 28, "b": 28, "children": []},{"a": 9, "b": 9, "children": []}]},{"a": 3, "b": 12, "children": [{"a": 10, "b": 10, "children": []},{"a": 11, "b": 11, "children": []},{"a": 12, "b": 12, "children": []}]}]}';
    document.getElementById('button').addEventListener('click', () => {
      var treejson = document.getElementById('jsonTreeText').value
      treejson = JSON.parse(treejson);
      var nodeGraph = new NodeGraphs(treejson, 'app');
    })
  </script>
</html>
